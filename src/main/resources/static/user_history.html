<!DOCTYPE html>

<html>

<head>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
  <script>
    function setPage(){
      if (localStorage.getItem('auth') == "guest") {
        let menu_items = document.getElementsByClassName("nav-link");

        menu_items[1].classList.add("disabled");
        menu_items[2].classList.add("disabled");
        menu_items[3].classList.add("disabled");
      } else if (localStorage.getItem('auth') == "admin") {
        let menu_items = document.getElementsByClassName("nav-link");
        menu_items[2].setAttribute("href","./user_history.html");

      } else {
        let menu_items = document.getElementsByClassName("nav-link");
        menu_items[1].classList.add("disabled");
        menu_items[3].classList.add("disabled");

      }

      //Get All Users
      const Http = new XMLHttpRequest();
      const url = 'http://localhost:8080/users/all';
      Http.open("GET", url);
      Http.send();
      Http.getResponseHeader("Content-type");

      Http.onload = function() {
        const obj = JSON.parse(this.responseText);
        Object.entries(obj).forEach(([key,value]) => {

          const obje = document.createElement("li");
          const btn = document.createElement("a");
          obje.appendChild(btn);
          obje.classList.add("list-group-item");
          btn.setAttribute("href","history.html?user="+value.id);
          btn.innerText = value.username
          document.getElementById("users_list").appendChild(obje);
        });
      }
    }
  </script>
</head>
<header>

  <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <a class="navbar-brand" href="#">Animal Shelter</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link" href="./index.html">Home</a>
        </li>
        <li class="nav-item">
          <a class="nav-link " href="./walk.html">Animals on walk</a>
        </li>
        <li class="nav-item">
          <a class="nav-link " href="./history.html">History</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="./add_animal.html">Add Animal</a>
        </li>
      </ul>
    </div>
  </nav>
</header>

<body onload="setPage()">
<ul id="users_list" class="list-group">
  <li class="list-group-item">
    <a href="admin_history.html">UserName</a>
  </li>
  <li class="list-group-item">
    <a href="admin_history.html">UserName</a>
  </li>
  <li class="list-group-item">
    <a href="admin_history.html">UserName</a>
  </li>
</ul>


</body>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>

</html>